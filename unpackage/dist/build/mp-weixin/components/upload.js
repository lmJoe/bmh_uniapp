(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/upload"],{2538:function(e,t,o){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={data:function(){return{sourceType:["拍摄","相册","拍摄或相册"],cameraIndex:0,cameraList:[{value:"back",name:"后置摄像头",checked:"true"},{value:"front",name:"前置摄像头"}],uploadWidth:"",uploadHeight:"",videoUrl:"https://img.cdn.aliyun.dcloud.net.cn/guide/uniapp/%E7%AC%AC1%E8%AE%B2%EF%BC%88uni-app%E4%BA%A7%E5%93%81%E4%BB%8B%E7%BB%8D%EF%BC%89-%20DCloud%E5%AE%98%E6%96%B9%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B@20181126-lite.m4v",videoName:"",uploadSuccess:!1,areaNum:0,tagList:[{id:1,name:"生活记录",inverted:!0},{id:2,name:"生活",inverted:!0},{id:3,name:"自制",inverted:!0},{id:4,name:"学习",inverted:!0},{id:5,name:"VLOG",inverted:!0},{id:6,name:"记录",inverted:!0}],loadProgress:0,dltDownLvNew:"",dltDownLvAll:"",dltDownLvWc:"",downloadUlr:"",suffix:""}},created:function(){},mounted:function(){},methods:{bindTextAreaBlur:function(e){console.log(e.detail.value.length),this.areaNum=e.detail.value.length},chosePost:function(){console.log("选择封面")},setInverted:function(t){var o=e.createSelectorQuery().in(this);o.selectAll(".tag").boundingClientRect((function(e){for(var o=0;o<e.length;o++)e[o].id==t.id&&(t.inverted=!t.inverted)})).exec()},upLoadVideo:function(){var t=this;e.chooseVideo({count:1,camera:this.cameraList[this.cameraIndex].value,sourceType:["album","camera"],success:function(o){o.tempFilePath;t.uploadWidth=o.width,t.uploadHeight=o.height,t.videoName=o.name,t.uploadSuccess=!0,e.showLoading({title:"上传中...",mask:!0,success:function(){setTimeout((function(){e.hideLoading()}),3e3)},fail:"",complete:function(){}})}})},getLocation:function(){var t=this;e.getStorageSync("token")&&e.getLocation({type:"gcj02 ",success:function(o){e.setStorageSync("userLocation",JSON.stringify(o)),t.request({url:"/driver/order/point_upload",data:{location:o.longitude+","+o.latitude,locatetime:(new Date).getTime()||"",speed:o.speed||"",accuracy:o.accuracy||""},method:"post"}).then((function(t){e.showToast({title:t.msg,icon:"none"})}))},fail:function(){e.showToast({title:"获取位置失败",icon:"none"})}})},storeLocal:function(){var t=this,o=this.videoUrl;if(this.downloadUlr=o,this.suffix=o.split(".")[o.split(".").length-1],"MP4"==o.substring(o.length-3)||"mp4"==o.substring(o.length-3)||"jpg"==o.substring(o.length-3)||"png"==o.substring(o.length-3)){var n=e.downloadFile({url:o,success:function(t){200===t.statusCode?"mp4"==t.tempFilePath.substring(t.tempFilePath.length-3)||"MP4"==t.tempFilePath.substring(t.tempFilePath.length-3)?e.saveVideoToPhotosAlbum({filePath:t.tempFilePath,success:function(){e.showToast({title:"保存成功",icon:"none",duration:2e3,mask:!0})},fail:function(){this.loadProgress=0,e.showToast({title:"保存失败",icon:"none"})}}):e.saveImageToPhotosAlbum({filePath:t.tempFilePath,success:function(){e.showToast({title:"保存成功",icon:"none",duration:2e3,mask:!0})},fail:function(){this.loadProgress=0,e.showToast({title:"保存失败",icon:"none"})}}):e.showToast({title:"下载失败",icon:"none"})},fail:function(o){t.loadProgress=0,e.showToast({icon:"none",mask:!0,title:"下载失败"})}});n.onProgressUpdate((function(e){t.loadProgress=e.progress,t.loadProgress<100||(t.loadProgress=0),e.totalBytesExpectedToWrite<10485760?(t.dltDownLvNew=Math.ceil(e.totalBytesWritten/1024)+"KB",t.dltDownLvAll=Math.ceil(e.totalBytesExpectedToWrite/1024)+"KB",t.dltDownLvWc=e.progress+"%"):(t.dltDownLvNew=Math.ceil(e.totalBytesWritten/1048576)+"M",t.dltDownLvAll=Math.ceil(e.totalBytesExpectedToWrite/1048576)+"M",t.dltDownLvWc=e.progress+"%")}))}else{var i=this,a=e.downloadFile({url:o,success:function(o){if(e.hideLoading(),200===o.statusCode){o.tempFilePath;var n=i.downloadUlr.split("/")[i.downloadUlr.split("/").length-1],a=wx.getFileSystemManager();a.saveFile({tempFilePath:o.tempFilePath,filePath:wx.env.USER_DATA_PATH+"/"+n,success:function(t){"saveFile:ok"==t.errMsg?"android"===e.getSystemInfoSync().platform?e.showModal({title:"保存地址为",content:"手机存储/Android/data/com.tencent.mm/MicroMsg/wxanewfiles"}):e.showToast({title:"请转移APP下载",icon:"none"}):e.showToast({title:"下载失败",icon:"none"})},fail:function(){e.showToast({title:"下载失败",icon:"none"})}})}else t.loadProgress=0,e.showToast({icon:"none",mask:!0,title:"下载失败"})},fail:function(o){t.arcZzShow=!1,t.loadProgress=0,e.showToast({icon:"none",mask:!0,title:"下载失败"})}});a.onProgressUpdate((function(e){t.loadProgress=e.progress,t.loadProgress<100||(t.loadProgress=0),e.totalBytesExpectedToWrite<10485760?(t.dltDownLvNew=Math.ceil(e.totalBytesWritten/1024)+"KB",t.dltDownLvAll=Math.ceil(e.totalBytesExpectedToWrite/1024)+"KB",t.dltDownLvWc=e.progress+"%"):(t.dltDownLvNew=Math.ceil(e.totalBytesWritten/1048576)+"M",t.dltDownLvAll=Math.ceil(e.totalBytesExpectedToWrite/1048576)+"M",t.dltDownLvWc=e.progress+"%")}))}},fSetFileName:function(e,t){t=t.split("/")[t.split("/").length-1],e.split("/").splice(0,e.split("/").length-1);var o=this.downloadUlr,n=plus.downloader.createDownload(o,{filename:"file://storage/emulated/0/AAA/"+t},(function(e,t){if(200==t)plus.io.convertLocalFileSystemURL(e.filename);else plus.downloader.clear()}));n.start()}}};t.default=o}).call(this,o("543d")["default"])},4911:function(e,t,o){"use strict";var n=o("ce6a"),i=o.n(n);i.a},"9e86":function(e,t,o){"use strict";o.d(t,"b",(function(){return i})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return n}));var n={uniTag:function(){return o.e("uni_modules/uni-tag/components/uni-tag/uni-tag").then(o.bind(null,"4be1"))}},i=function(){var e=this,t=e.$createElement;e._self._c},a=[]},c5cf:function(e,t,o){"use strict";o.r(t);var n=o("2538"),i=o.n(n);for(var a in n)"default"!==a&&function(e){o.d(t,e,(function(){return n[e]}))}(a);t["default"]=i.a},cb3c:function(e,t,o){"use strict";o.r(t);var n=o("9e86"),i=o("c5cf");for(var a in i)"default"!==a&&function(e){o.d(t,e,(function(){return i[e]}))}(a);o("4911");var l,s=o("f0c5"),c=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"fe89cfac",null,!1,n["a"],l);t["default"]=c.exports},ce6a:function(e,t,o){},de4a:function(e,t,o){"use strict";(function(e){o("f0d3");n(o("66fd"));var t=n(o("cb3c"));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=o,e(t.default)}).call(this,o("543d")["createPage"])}},[["de4a","common/runtime","common/vendor"]]]);